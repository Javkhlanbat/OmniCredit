# OmniCredit - –û–Ω–ª–∞–π–Ω –ó—ç—ç–ª–∏–π–Ω –ü–ª–∞—Ç—Ñ–æ—Ä–º

> Modern full-stack –∑—ç—ç–ª–∏–π–Ω –ø–ª–∞—Ç—Ñ–æ—Ä–º. React + Node.js + PostgreSQL –∞—à–∏–≥–ª–∞—Å–∞–Ω.

## üìã –ê–≥—É—É–ª–≥–∞

- [–ï—Ä”©–Ω—Ö–∏–π —Ç–∞–Ω–∏–ª—Ü—É—É–ª–≥–∞](#–µ—Ä”©–Ω—Ö–∏–π-—Ç–∞–Ω–∏–ª—Ü—É—É–ª–≥–∞)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π–Ω Stack](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π–Ω-stack)
- [–°–∏—Å—Ç–µ–º–∏–π–Ω –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä](#—Å–∏—Å—Ç–µ–º–∏–π–Ω-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä)
- [Database Schema](#database-schema)
- [Backend - –•—ç—Ä—Ö—ç–Ω –∞–∂–∏–ª–ª–∞–¥–∞–≥](#backend---—Ö—ç—Ä—Ö—ç–Ω-–∞–∂–∏–ª–ª–∞–¥–∞–≥)
- [Frontend - –•—ç—Ä—Ö—ç–Ω –∞–∂–∏–ª–ª–∞–¥–∞–≥](#frontend---—Ö—ç—Ä—Ö—ç–Ω-–∞–∂–∏–ª–ª–∞–¥–∞–≥)
- [–ì–æ–ª –§—É–Ω–∫—Ü“Ø“Ø–¥](#–≥–æ–ª-—Ñ—É–Ω–∫—Ü“Ø“Ø–¥)
- [Analytics System](#analytics-system)
- [–ê—é—É–ª–≥“Ø–π –±–∞–π–¥–∞–ª](#–∞—é—É–ª–≥“Ø–π-–±–∞–π–¥–∞–ª)
- [Installation](#installation)
- [Demo](#demo)

---

## üéØ –ï—Ä”©–Ω—Ö–∏–π —Ç–∞–Ω–∏–ª—Ü—É—É–ª–≥–∞

**OmniCredit** –Ω—å —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ –æ–Ω–ª–∞–π–Ω–∞–∞—Ä –∑—ç—ç–ª —Ö“Ø—Å—ç—Ö, —Ç”©–ª–±”©—Ä —Ö–∏–π—Ö, wallet —É–¥–∏—Ä–¥–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º —é–º. Admin –Ω–∞—Ä –∑—ç—ç–ª –∑”©–≤—à”©”©—Ä”©—Ö, —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω analytics —Ö–∞—Ä–∞—Ö –±–æ–ª–æ–º–∂—Ç–æ–π.

### –®–∏–π–¥—Å—ç–Ω –∞—Å—É—É–¥–∞–ª:
- ‚ùå –£–ª–∞–º–∂–ª–∞–ª—Ç –±–∞–Ω–∫: 3-7 —Ö–æ–Ω–æ–≥ —Ö“Ø–ª—ç—ç—Ö, –æ–ª–æ–Ω —Ü–∞–∞—Å, —Ö—è–∑–≥–∞–∞—Ä–ª–∞–≥–¥–º–∞–ª —Ü–∞–≥
- ‚úÖ OmniCredit: 24/7 –æ–Ω–ª–∞–π–Ω, –∞–≤—Ç–æ–º–∞—Ç —Ç–æ–æ—Ü–æ–æ–ª—É—É—Ä, real-time tracking, digital –±–∞—Ä–∏–º—Ç

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–π–Ω Stack

### Frontend (Client)
- **React.js** - Modern UI library (SPA)
- **React Router** - Client-side navigation
- **CSS3** - Custom styling, responsive design
- **localStorage/sessionStorage** - Client-side data persistence

### Backend (Server)
- **Node.js** - JavaScript runtime
- **Express.js** - Web framework, REST API
- **PostgreSQL** - Relational database
- **JWT** - Authentication
- **bcrypt** - Password hashing

### DevOps
- **Git/GitHub** - Version control
- **Render.com** - Cloud hosting (Production)
- **dotenv** - Environment variables

---

## üèó –°–∏—Å—Ç–µ–º–∏–π–Ω –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Browser (Client)                     ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ  React UI  ‚îÇ  ‚îÇ   Router   ‚îÇ  ‚îÇ LocalStorage ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ        ‚îÇ                ‚îÇ                ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                ‚îÇ                ‚îÇ
         ‚îÇ  HTTP Requests (JSON + JWT Token)
         ‚îÇ                ‚îÇ                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Node.js + Express Server                   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
‚îÇ  ‚îÇ  Routes  ‚îÇ‚Üí ‚îÇControllers‚îÇ‚Üí ‚îÇ Models  ‚îÇ               ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
‚îÇ                                    ‚îÇ                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                     ‚îÇ
                                     ‚îÇ SQL Queries
                                     ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  PostgreSQL Database                     ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  [users] [loans] [payments] [wallets] [analytics]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ú—ç–¥—ç—ç–ª–ª–∏–π–Ω —É—Ä—Å–≥–∞–ª:
1. **Browser** - –•—ç—Ä—ç–≥–ª—ç–≥—á button –¥–∞—Ä–Ω–∞
2. **React** - Event handler –∞–∂–∏–ª–ª–∞–∂ API request –∏–ª–≥—ç—ç–Ω—ç
3. **Express Router** - Request —Ö“Ø–ª—ç—ç–∂ –∞–≤–Ω–∞ (`/api/loans/apply`)
4. **Controller** - Business logic –∞–∂–∏–ª–ª—É—É–ª–Ω–∞ (validation, —Ç–æ–æ—Ü–æ–æ–ª–æ–ª)
5. **Model** - PostgreSQL-–¥ SQL query –∏–ª–≥—ç—ç–Ω—ç
6. **Database** - ”®–≥”©–≥–¥”©–ª –±—É—Ü–∞–∞–Ω–∞
7. **Response** - JSON format-–∞–∞—Ä browser —Ä—É—É –±—É—Ü–Ω–∞
8. **React** - State —à–∏–Ω—ç—á–ª—ç—ç–¥ UI update —Ö–∏–π–Ω—ç

---

## üíæ Database Schema

### “Æ–Ω–¥—Å—ç–Ω Tables (13 tables)

#### 1. `users` - –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥
```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,         -- bcrypt hash
  first_name VARCHAR(100) NOT NULL,
  last_name VARCHAR(100) NOT NULL,
  phone VARCHAR(20),
  register_number VARCHAR(20) UNIQUE,     -- –†–µ–≥–∏—Å—Ç—Ä–∏–π–Ω –¥—É–≥–∞–∞—Ä
  id_front TEXT,                          -- “Æ–Ω—ç–º–ª—ç—Ö–Ω–∏–π —É—Ä–¥ —Ç–∞–ª (base64)
  id_back TEXT,                           -- “Æ–Ω—ç–º–ª—ç—Ö–Ω–∏–π –∞—Ä–¥ —Ç–∞–ª (base64)
  is_admin BOOLEAN DEFAULT false,
  visit_count INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 2. `loans` - –ó—ç—ç–ª“Ø“Ø–¥
```sql
CREATE TABLE loans (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  loan_type VARCHAR(50) NOT NULL,         -- 'personal', 'business', etc.
  amount DECIMAL(12, 2) NOT NULL,         -- –ó—ç—ç–ª–∏–π–Ω –¥“Ø–Ω
  interest_rate DECIMAL(5, 2) NOT NULL,   -- –ñ–∏–ª–∏–π–Ω —Ö“Ø“Ø (%)
  term_months INTEGER NOT NULL,           -- –•—É–≥–∞—Ü–∞–∞ (—Å–∞—Ä)
  monthly_payment DECIMAL(12, 2),         -- –°–∞—Ä—ã–Ω —Ç”©–ª–±”©—Ä
  total_amount DECIMAL(12, 2),            -- –ù–∏–π—Ç —Ç”©–ª–±”©—Ä (principal + interest)
  status VARCHAR(50) DEFAULT 'pending',   -- pending/approved/disbursed/rejected
  purpose TEXT,
  promo_code_id INTEGER REFERENCES promo_codes(id),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 3. `payments` - –¢”©–ª–±”©—Ä“Ø“Ø–¥
```sql
CREATE TABLE payments (
  id SERIAL PRIMARY KEY,
  loan_id INTEGER REFERENCES loans(id),
  amount DECIMAL(12, 2) NOT NULL,         -- –¢”©–ª—Å”©–Ω –¥“Ø–Ω
  principal_amount DECIMAL(12, 2),        -- “Æ–Ω–¥—Å—ç–Ω —Ç”©–ª–±”©—Ä —Ö—ç—Å—ç–≥
  interest_amount DECIMAL(12, 2),         -- –•“Ø“Ø–≥–∏–π–Ω —Ç”©–ª–±”©—Ä —Ö—ç—Å—ç–≥
  payment_method VARCHAR(50),
  status VARCHAR(50) DEFAULT 'completed',
  payment_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 4. `wallets` - –•—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω wallet
```sql
CREATE TABLE wallets (
  id SERIAL PRIMARY KEY,
  user_id INTEGER UNIQUE REFERENCES users(id),
  balance DECIMAL(12, 2) DEFAULT 0,       -- “Æ–ª–¥—ç–≥–¥—ç–ª
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 5. `user_activities` - Analytics tracking
```sql
CREATE TABLE user_activities (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  session_id VARCHAR(100),
  page_url VARCHAR(500),
  action_type VARCHAR(100),               -- page_view, click, etc.
  time_spent INTEGER DEFAULT 0,           -- Seconds
  device_info JSONB,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**–ë—É—Å–∞–¥ tables:**
- `wallet_transactions` - Wallet –≥“Ø–π–ª–≥—ç—ç–Ω–∏–π —Ç“Ø“Ø—Ö
- `companies` - –ö–æ–º–ø–∞–Ω–∏—É–¥
- `promo_codes` - –ü—Ä–æ–º–æ –∫–æ–¥—É—É–¥
- `user_sessions` - Session tracking
- `analytics_events` - Event tracking
- `funnel_sessions` - Funnel analysis

---

## üîß Backend - –•—ç—Ä—Ö—ç–Ω –∞–∂–∏–ª–ª–∞–¥–∞–≥

### Folder Structure
```
backend/
‚îú‚îÄ‚îÄ server.js                 # Entry point
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.js       # PostgreSQL connection pool
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ init-db.js        # Database tables “Ø“Ø—Å–≥—ç—Ö
‚îÇ   ‚îú‚îÄ‚îÄ controllers/          # Business logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loanController.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ paymentController.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analyticsController.js
‚îÇ   ‚îú‚îÄ‚îÄ models/               # Database queries
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ userModel.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loanModel.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ paymentModel.js
‚îÇ   ‚îú‚îÄ‚îÄ routes/               # API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ authRoutes.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loanRoutes.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tracking.js
‚îÇ   ‚îî‚îÄ‚îÄ middleware/
‚îÇ       ‚îú‚îÄ‚îÄ authMiddleware.js # JWT verification
‚îÇ       ‚îî‚îÄ‚îÄ adminMiddleware.js
```

### Authentication Flow (JWT)

#### 1. –ë“Ø—Ä—Ç–≥—ç–ª (`POST /api/auth/register`)
```javascript
// authController.js
const register = async (req, res) => {
  const { email, password, first_name, last_name } = req.body;

  // 1. Password hash —Ö–∏–π—Ö
  const hashedPassword = await bcrypt.hash(password, 10);

  // 2. Database-–¥ —Ö–∞–¥–≥–∞–ª–∞—Ö
  const user = await userModel.create({
    email,
    password: hashedPassword,
    first_name,
    last_name
  });

  // 3. JWT token “Ø“Ø—Å–≥—ç—Ö
  const token = jwt.sign(
    { userId: user.id, email: user.email },
    process.env.JWT_SECRET,
    { expiresIn: '24h' }
  );

  // 4. Client —Ä—É—É –±—É—Ü–∞–∞—Ö
  res.json({ token, user });
};
```

**–Ø–∞–≥–∞–∞–¥ JWT?**
- Stateless: Server –¥—ç—ç—Ä session —Ö–∞–¥–≥–∞–ª–∞—Ö–≥“Ø–π
- Scalable: Multiple server-—Ç—ç–π –∞–∂–∏–ª–ª–∞–Ω–∞
- Secure: Secret key-—ç—ç—Ä signed, expire date-—Ç–∞–π

#### 2. –ù—ç–≤—Ç—Ä—ç—Ö (`POST /api/auth/login`)
```javascript
const login = async (req, res) => {
  const { email, password } = req.body;

  // 1. Database-—Å —Ö—ç—Ä—ç–≥–ª—ç–≥—á —Ö–∞–π—Ö
  const user = await userModel.findByEmail(email);
  if (!user) {
    return res.status(401).json({ error: '–ò-–º—ç–π–ª —ç—Å–≤—ç–ª –Ω—É—É—Ü “Ø–≥ –±—É—Ä—É—É' });
  }

  // 2. Password —à–∞–ª–≥–∞—Ö
  const isValidPassword = await bcrypt.compare(password, user.password);
  if (!isValidPassword) {
    return res.status(401).json({ error: '–ò-–º—ç–π–ª —ç—Å–≤—ç–ª –Ω—É—É—Ü “Ø–≥ –±—É—Ä—É—É' });
  }

  // 3. JWT token “Ø“Ø—Å–≥—ç—Ö
  const token = jwt.sign(
    { userId: user.id, email: user.email },
    process.env.JWT_SECRET,
    { expiresIn: '24h' }
  );

  res.json({ token, user });
};
```

#### 3. Protected Route (Middleware)
```javascript
// authMiddleware.js
const authenticateToken = (req, res, next) => {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1]; // "Bearer TOKEN"

  if (!token) {
    return res.status(401).json({ error: '–ù—ç–≤—Ç—Ä—ç—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π' });
  }

  try {
    // Token verify —Ö–∏–π—Ö
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded; // { userId, email }
    next(); // –î–∞—Ä–∞–∞–≥–∏–π–Ω middleware —Ä—É—É
  } catch (error) {
    return res.status(403).json({ error: 'Token —Ö“Ø—á–∏–Ω–≥“Ø–π' });
  }
};
```

**–ê—à–∏–≥–ª–∞–ª—Ç:**
```javascript
// loanRoutes.js
router.get('/my-loans', authenticateToken, async (req, res) => {
  const userId = req.user.userId; // Middleware-—Å –∏—Ä—Å—ç–Ω
  const loans = await loanModel.getUserLoans(userId);
  res.json({ loans });
});
```

### –ó—ç—ç–ª–∏–π–Ω –¢–æ–æ—Ü–æ–æ–ª–æ–ª

#### Monthly Payment Formula
```javascript
// loanController.js
const calculateMonthlyPayment = (principal, annualRate, months) => {
  const monthlyRate = annualRate / 100 / 12;

  if (monthlyRate === 0) {
    return principal / months;
  }

  // Compound interest formula:
  // M = P √ó [r(1+r)^n] / [(1+r)^n - 1]
  const monthlyPayment = principal *
    (monthlyRate * Math.pow(1 + monthlyRate, months)) /
    (Math.pow(1 + monthlyRate, months) - 1);

  return Math.round(monthlyPayment * 100) / 100;
};
```

**–ñ–∏—à—ç—ç:**
```
Principal: 1,000,000‚ÇÆ
Annual Rate: 12% (0.12)
Term: 12 months

Monthly Rate: 0.12 / 12 = 0.01 (1%)
Monthly Payment: 88,849‚ÇÆ
Total Payment: 1,066,188‚ÇÆ
Total Interest: 66,188‚ÇÆ
```

#### Interest Accrual (–°–∞—Ä –±“Ø—Ä–∏–π–Ω —Ö“Ø“Ø)
```javascript
// paymentModel.js
const getLoanBalance = async (loanId) => {
  // 1. –ó—ç—ç–ª–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª –∞–≤–∞—Ö
  const loan = await query('SELECT * FROM loans WHERE id = $1', [loanId]);

  // 2. –¢”©–ª—Å”©–Ω principal –∞–≤–∞—Ö
  const paymentsResult = await query(`
    SELECT SUM(principal_amount) as total_principal
    FROM payments
    WHERE loan_id = $1
  `, [loanId]);

  const paidPrincipal = paymentsResult.rows[0].total_principal || 0;
  const remainingPrincipal = loan.amount - paidPrincipal;

  // 3. –•“Ø“Ø —Ç–æ–æ—Ü–æ–æ–ª–æ—Ö (—Å–∞—Ä –±“Ø—Ä –Ω—ç–º—ç–≥–¥—ç–Ω—ç)
  const monthsElapsed = Math.floor(
    (Date.now() - new Date(loan.created_at)) / (30 * 24 * 60 * 60 * 1000)
  );

  const monthlyRate = loan.interest_rate / 100 / 12;
  const accruedInterest = remainingPrincipal * monthlyRate * monthsElapsed;

  return {
    remainingPrincipal,
    accruedInterest,
    totalBalance: remainingPrincipal + accruedInterest
  };
};
```

#### Payment Allocation (–¢”©–ª–±”©—Ä —Ö—É–≤–∞–∞—Ä–∏–ª–∞—Ö)
```javascript
// paymentModel.js
const createPayment = async ({ loan_id, amount, payment_method }) => {
  // 1. “Æ–ª–¥—ç–≥–¥—ç–ª –∞–≤–∞—Ö
  const balance = await getLoanBalance(loan_id);

  // 2. –¢”©–ª–±”©—Ä–∏–π–≥ —Ö—É–≤–∞–∞—Ö: —ç—Ö–ª—ç—ç–¥ —Ö“Ø“Ø, –¥–∞—Ä–∞–∞ principal
  let interestPaid = 0;
  let principalPaid = 0;

  if (amount >= balance.accruedInterest) {
    // –•“Ø“Ø –±“Ø—Ä—ç–Ω —Ç”©–ª”©–≥–¥”©–Ω”©
    interestPaid = balance.accruedInterest;
    principalPaid = amount - interestPaid;
  } else {
    // –ó”©–≤—Ö”©–Ω —Ö“Ø“Ø —Ç”©–ª”©–≥–¥”©–Ω”©
    interestPaid = amount;
    principalPaid = 0;
  }

  // 3. Database-–¥ —Ö–∞–¥–≥–∞–ª–∞—Ö
  await query(`
    INSERT INTO payments
    (loan_id, amount, principal_amount, interest_amount, payment_method, status)
    VALUES ($1, $2, $3, $4, $5, 'completed')
  `, [loan_id, amount, principalPaid, interestPaid, payment_method]);

  return { interestPaid, principalPaid };
};
```

---

## ‚öõÔ∏è Frontend - –•—ç—Ä—Ö—ç–Ω –∞–∂–∏–ª–ª–∞–¥–∞–≥

### Folder Structure
```
omnicredit-react/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ pages/                # React components (pages)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Login.jsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Register.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoanCalculator.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoanApplication.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MyLoans.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Payment.jsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Admin.jsx
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ common/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Navigation.jsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Footer.jsx
‚îÇ   ‚îú‚îÄ‚îÄ services/             # API calls
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trackingService.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ analytics.js
‚îÇ   ‚îú‚îÄ‚îÄ styles/               # CSS files
‚îÇ   ‚îî‚îÄ‚îÄ App.jsx               # Main component
```

### React Component Example

#### Login.jsx - –ù—ç–≤—Ç—Ä—ç—Ö —Ö—É—É–¥–∞—Å
```javascript
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { AuthAPI, TokenManager, LastPageManager } from '../services/api';

export default function Login() {
  const navigate = useNavigate();
  const [formData, setFormData] = useState({ email: '', password: '' });
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError('');

    try {
      // 1. API call —Ö–∏–π—Ö
      const response = await AuthAPI.login(formData.email, formData.password);

      // 2. Token –±–æ–ª–æ–Ω user –º—ç–¥—ç—ç–ª–ª–∏–π–≥ —Ö–∞–¥–≥–∞–ª–∞—Ö
      TokenManager.setToken(response.token);
      UserManager.setUser(response.user);

      // 3. Redirect —Ö–∏–π—Ö
      const redirectPath = LastPageManager.getRedirectPath();
      navigate(redirectPath);
    } catch (err) {
      setError(err.message || '–ù—ç–≤—Ç—Ä—ç—Ö “Ø–µ–¥ –∞–ª–¥–∞–∞ –≥–∞—Ä–ª–∞–∞');
    }
  };

  return (
    <div className="login-container">
      <form onSubmit={handleSubmit}>
        <input
          type="email"
          value={formData.email}
          onChange={(e) => setFormData({ ...formData, email: e.target.value })}
          placeholder="–ò-–º—ç–π–ª"
          required
        />
        <input
          type="password"
          value={formData.password}
          onChange={(e) => setFormData({ ...formData, password: e.target.value })}
          placeholder="–ù—É—É—Ü “Ø–≥"
          required
        />
        {error && <div className="error">{error}</div>}
        <button type="submit">–ù—ç–≤—Ç—Ä—ç—Ö</button>
      </form>
    </div>
  );
}
```

### API Service Layer

#### api.js - Centralized API calls
```javascript
// API Configuration
export const API_CONFIG = {
  BASE_URL: isLocalHost
    ? 'http://localhost:5000/api'
    : 'https://omnicredit-backend.onrender.com/api',
  TIMEOUT: 30000
};

// Token Manager
export const TokenManager = {
  setToken(token) {
    localStorage.setItem('authToken', token);
  },

  getToken() {
    return localStorage.getItem('authToken');
  },

  isAuthenticated() {
    const token = this.getToken();
    if (!token) return false;

    try {
      const payload = JSON.parse(atob(token.split('.')[1]));
      return payload.exp * 1000 > Date.now();
    } catch {
      return false;
    }
  }
};

// API Helper
const api = {
  async request(endpoint, options = {}) {
    const token = TokenManager.getToken();

    const config = {
      method: options.method || 'GET',
      headers: {
        'Content-Type': 'application/json',
        ...(token && { 'Authorization': `Bearer ${token}` }),
        ...options.headers
      },
      ...(options.body && { body: JSON.stringify(options.body) })
    };

    const response = await fetch(`${API_CONFIG.BASE_URL}${endpoint}`, config);

    if (!response.ok) {
      const error = await response.json();
      throw new Error(error.message || 'Request failed');
    }

    return response.json();
  },

  get(endpoint) {
    return this.request(endpoint);
  },

  post(endpoint, body) {
    return this.request(endpoint, { method: 'POST', body });
  }
};

// Auth API
export const AuthAPI = {
  async login(email, password) {
    return api.post('/auth/login', { email, password });
  },

  async register(userData) {
    return api.post('/auth/register', userData);
  }
};

// Loans API
export const LoansAPI = {
  async getMyLoans() {
    return api.get('/loans/my-loans');
  },

  async applyForLoan(loanData) {
    return api.post('/loans/apply', loanData);
  }
};
```

### State Management with useState

```javascript
// Dashboard.jsx
import { useState, useEffect } from 'react';

export default function Dashboard() {
  const [stats, setStats] = useState({
    totalLoans: 0,
    activeLoans: 0,
    walletBalance: 0
  });
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadDashboardData();
  }, []); // Mount —Ö–∏–π–≥–¥—ç—Ö—ç–¥ 1 —É–¥–∞–∞ –∞–∂–∏–ª–ª–∞–Ω–∞

  const loadDashboardData = async () => {
    try {
      setLoading(true);

      // Parallel requests
      const [loansData, walletData] = await Promise.all([
        LoansAPI.getMyLoans(),
        WalletAPI.getBalance()
      ]);

      setStats({
        totalLoans: loansData.loans.length,
        activeLoans: loansData.loans.filter(l => l.status === 'active').length,
        walletBalance: walletData.balance
      });
    } catch (error) {
      console.error('Error loading dashboard:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return <div>Loading...</div>;

  return (
    <div className="dashboard">
      <div className="stats-grid">
        <div className="stat-card">
          <h3>–ù–∏–π—Ç –∑—ç—ç–ª</h3>
          <p>{stats.totalLoans}</p>
        </div>
        <div className="stat-card">
          <h3>–ò–¥—ç–≤—Ö—Ç—ç–π –∑—ç—ç–ª</h3>
          <p>{stats.activeLoans}</p>
        </div>
        <div className="stat-card">
          <h3>Wallet “Ø–ª–¥—ç–≥–¥—ç–ª</h3>
          <p>‚ÇÆ{stats.walletBalance.toLocaleString()}</p>
        </div>
      </div>
    </div>
  );
}
```

---

## üéØ –ì–æ–ª –§—É–Ω–∫—Ü“Ø“Ø–¥

### 1. –ó—ç—ç–ª–∏–π–Ω –¢–æ–æ—Ü–æ–æ–ª—É—É—Ä

**Frontend (LoanCalculator.jsx):**
```javascript
const [calculation, setCalculation] = useState({
  amount: 1000000,
  termMonths: 12,
  interestRate: 1.5
});

const calculateLoan = () => {
  const { amount, termMonths, interestRate } = calculation;

  const monthlyRate = interestRate / 100;
  const monthlyPayment = amount *
    (monthlyRate * Math.pow(1 + monthlyRate, termMonths)) /
    (Math.pow(1 + monthlyRate, termMonths) - 1);

  const totalPayment = monthlyPayment * termMonths;
  const totalInterest = totalPayment - amount;

  return { monthlyPayment, totalPayment, totalInterest };
};
```

**Real-time update:**
```javascript
<input
  type="range"
  min="100000"
  max="10000000"
  step="100000"
  value={calculation.amount}
  onChange={(e) => setCalculation({
    ...calculation,
    amount: parseInt(e.target.value)
  })}
/>
<p>–°–∞—Ä—ã–Ω —Ç”©–ª–±”©—Ä: ‚ÇÆ{calculateLoan().monthlyPayment.toLocaleString()}</p>
```

### 2. –ó—É—Ä–∞–≥ Upload (Base64)

```javascript
const handleImageUpload = (e, field) => {
  const file = e.target.files[0];

  if (file.size > 5 * 1024 * 1024) {
    alert('–ó—É—Ä–∞–≥ 5MB-–∞–∞—Å –±–∞–≥–∞ –±–∞–π—Ö —ë—Å—Ç–æ–π');
    return;
  }

  const reader = new FileReader();
  reader.onloadend = () => {
    const base64String = reader.result; // "data:image/jpeg;base64,..."
    setFormData({ ...formData, [field]: base64String });
  };
  reader.readAsDataURL(file);
};
```

**Backend validation:**
```javascript
const isValidBase64Image = (str) => {
  return str.startsWith('data:image/');
};
```

### 3. Last Visited Page Tracking

```javascript
// App.jsx
import { useLocation } from 'react-router-dom';

function AppContent() {
  const location = useLocation();

  useEffect(() => {
    // Page view tracking
    trackingService.trackPageView(location.pathname, document.title);

    // –°“Ø“Ø–ª–¥ –∑–æ—á–∏–ª—Å–æ–Ω —Ö—É—É–¥—Å—ã–≥ —Ö–∞–¥–≥–∞–ª–∞—Ö
    if (TokenManager.isAuthenticated()) {
      LastPageManager.setLastPage(location.pathname);
    }
  }, [location]); // URL ”©”©—Ä—á–ª”©–≥–¥”©—Ö –±“Ø—Ä—Ç

  return <Routes>...</Routes>;
}
```

**Redirect logic:**
```javascript
// api.js
export const LastPageManager = {
  setLastPage(path) {
    const excludedPaths = ['/login', '/register', '/'];
    if (!excludedPaths.includes(path)) {
      localStorage.setItem('lastVisitedPage', path);
    }
  },

  getRedirectPath() {
    const lastPage = localStorage.getItem('lastVisitedPage');
    const user = UserManager.getUser();

    if (lastPage) return lastPage;
    if (user?.is_admin) return '/admin';
    return '/dashboard';
  }
};
```

---

## üìä Analytics System

### Architecture

```
Browser Event ‚Üí trackingService.js ‚Üí Backend API ‚Üí PostgreSQL
                                   ‚Üì
                              user_activities
                              user_sessions
                              analytics_events
```

### Frontend Tracking

```javascript
// trackingService.js
class TrackingService {
  constructor() {
    this.sessionId = this.getOrCreateSessionId();
    this.setupEventListeners();
  }

  async trackPageView(pagePath, pageTitle) {
    await this.trackActivity('page_view', {
      page_url: pagePath,
      page_title: pageTitle,
      time_spent: Math.floor((Date.now() - this.pageStartTime) / 1000)
    });
  }

  setupEventListeners() {
    // Click tracking
    document.addEventListener('click', (e) => {
      if (e.target.matches('button, a')) {
        this.trackActivity('click', {
          element_type: e.target.tagName,
          element_text: e.target.innerText
        });
      }
    });

    // Page unload tracking
    window.addEventListener('beforeunload', () => {
      const timeSpent = Math.floor((Date.now() - this.pageStartTime) / 1000);
      navigator.sendBeacon(
        `${API_URL}/tracking/activity`,
        JSON.stringify({ action_type: 'page_exit', time_spent: timeSpent })
      );
    });
  }
}
```

### Backend Analytics Queries

#### Funnel Analysis
```javascript
// tracking.js
router.get('/funnel', authenticateToken, async (req, res) => {
  const funnelData = await pool.query(`
    WITH funnel_stages AS (
      SELECT
        COUNT(DISTINCT CASE WHEN page_url = '/' THEN session_id END) as homepage,
        COUNT(DISTINCT CASE WHEN page_url LIKE '%/loan%' THEN session_id END) as loan_page,
        COUNT(DISTINCT CASE WHEN page_url LIKE '%/calculator%' THEN session_id END) as calculator,
        COUNT(DISTINCT CASE WHEN action_type = 'loan_application' THEN session_id END) as applied
      FROM user_activities
      WHERE created_at >= NOW() - INTERVAL '30 days'
    )
    SELECT * FROM funnel_stages
  `);

  res.json({ stages: funnelData.rows[0] });
});
```

#### Navigation Flow (Window Function)
```sql
WITH page_sequence AS (
  SELECT
    session_id,
    page_url,
    created_at,
    LEAD(page_url) OVER (
      PARTITION BY session_id
      ORDER BY created_at
    ) as next_page
  FROM user_activities
  WHERE action_type = 'page_view'
)
SELECT
  page_url as from_page,
  next_page as to_page,
  COUNT(*) as transition_count
FROM page_sequence
WHERE next_page IS NOT NULL
GROUP BY page_url, next_page
ORDER BY transition_count DESC
```

**“Æ—Ä –¥“Ø–Ω:**
```
from_page        | to_page          | transition_count
-----------------+------------------+-----------------
/                | /zeelhuudas      | 145
/zeelhuudas      | /application     | 87
/application     | /dashboard       | 52
```

---

## üîí –ê—é—É–ª–≥“Ø–π –±–∞–π–¥–∞–ª

### 1. SQL Injection Prevention
```javascript
// ‚ùå –ë–£–†–£–£ - SQL injection possible
const email = req.body.email;
const query = `SELECT * FROM users WHERE email = '${email}'`;

// ‚úÖ –ó”®–í - Parameterized query
const query = 'SELECT * FROM users WHERE email = $1';
const result = await pool.query(query, [email]);
```

### 2. Password Security
```javascript
// Registration
const password = 'user123';
const hashedPassword = await bcrypt.hash(password, 10); // Salt rounds: 10
// Result: "$2b$10$N9qo8uLOickgx2ZMRZoMye..."

// Login
const isValid = await bcrypt.compare(password, hashedPassword);
// bcrypt –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä salt-—ã–≥ hash-–∞–∞—Å —Å–∞–ª–≥–∞–∂ —à–∞–ª–≥–∞–Ω–∞
```

### 3. XSS Protection
```javascript
// React –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä escape —Ö–∏–π–¥—ç–≥
const userInput = '<script>alert("XSS")</script>';
return <div>{userInput}</div>;
// Rendered: &lt;script&gt;alert("XSS")&lt;/script&gt;
```

### 4. CORS Configuration
```javascript
// server.js
const allowedOrigins = [
  'http://localhost:5173',
  'https://omnicredit-frontend.onrender.com'
];

app.use(cors({
  origin: function(origin, callback) {
    if (!origin || allowedOrigins.includes(origin)) {
      callback(null, true);
    } else {
      callback(new Error('CORS policy violation'));
    }
  },
  credentials: true
}));
```

---

## üöÄ Installation

### Prerequisites
- Node.js 16+
- PostgreSQL 14+
- Git

### Backend Setup
```bash
cd backend
npm install

# Create .env file
DATABASE_URL=postgresql://user:password@localhost:5432/omnicredit
JWT_SECRET=your-secret-key-here
PORT=5000

# Run database initialization
npm start
# Tables –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä “Ø“Ø—Å–≥—ç–≥–¥—ç–Ω—ç
```

### Frontend Setup
```bash
cd omnicredit-react
npm install
npm run dev
# Opens http://localhost:5173
```

---

## üåê Demo

**Production URLs:**
- Frontend: https://omnicredit-frontend.onrender.com
- Backend API: https://omnicredit-backend.onrender.com

**Test Credentials:**
```
Admin:
  Email: admin@omnicredit.com
  Password: admin123

User:
  Email: user@test.com
  Password: user123
```

---

## üìà Metrics

- **Database Tables:** 13
- **API Endpoints:** 25+
- **React Components:** 20+
- **Lines of Code:** ~5,000+
- **GitHub Commits:** 15+

---

## üéì –°—É—Ä–∞–ª—Ü—Å–∞–Ω –∑“Ø–π–ª—Å

### Technical Skills
- ‚úÖ React.js component lifecycle
- ‚úÖ React Hooks (useState, useEffect, useLocation)
- ‚úÖ JWT authentication implementation
- ‚úÖ RESTful API design
- ‚úÖ PostgreSQL database design & queries
- ‚úÖ SQL window functions, CTEs
- ‚úÖ bcrypt password hashing
- ‚úÖ Base64 image encoding
- ‚úÖ Cloud deployment (Render.com)
- ‚úÖ Git version control

### Soft Skills
- Problem decomposition
- Code organization (MVC pattern)
- Error handling
- Security best practices
- Documentation

---

## üîÆ Future Improvements

1. **Mobile App** - React Native
2. **AI Credit Scoring** - Machine learning
3. **Payment Gateway** - Qpay, SocialPay integration
4. **SMS Notifications** - Twilio API
5. **E-Signature** - Digital signature integration
6. **Multi-language** - i18n support

---

## üìû Contact

- GitHub: [@Javkhlanbat](https://github.com/Javkhlanbat/OmniCredit)
- Demo: [omnicredit-frontend.onrender.com](https://omnicredit-frontend.onrender.com)

---

**¬© 2024-2025 OmniCredit. –ë“Ø—Ö —ç—Ä—Ö —Ö—É—É–ª–∏–∞—Ä —Ö–∞–º–≥–∞–∞–ª–∞–≥–¥—Å–∞–Ω.**
